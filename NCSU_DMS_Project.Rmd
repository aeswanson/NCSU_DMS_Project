---
title: "Simple and Mixed Model Analysis"
author: "Alexis Swanson"
date: "3/3/2021"
output:
  word_document: default
  html_document: default
---

#Histograms of the 3 Approaches for tc
  
```{r, echo=FALSE, message=FALSE}

data <- read.csv("/Users/swans/Documents/Research/SiteData_Mar_3_2021.csv")

hist(data$tc.B)
hist(data$tc.S)
hist(data$tc.I)

hist(data$D50)


hist(log(data$tc.B))
data$log.tc = log(data$tc.B)
data$log.tc[data$log.tc== "-Inf"] <- 0

range(data$tc.B)
range(data$tc.S)
range(data$tc.I)
```

The ranges are for Blaisdell, Scour Depth and the Iterative solutions respectively. 

After our discussion on 2/18 the concensus was to move forward using the Blaisdell solution.

# First Linear Model
  # All Predictors

```{r, echo=FALSE, message=FALSE}

library(ggplot2)

model_simple <-lm(log.tc ~ Temp + EC + Cor.Moist + D50 + Cu + Cc + GSD + Pass200, data = data)
summary(model_simple)

par(mfrow = c(2,2))
plot(model_simple)
par(mfrow = c(1,1))
qqnorm(resid(model_simple))
qqline(resid(model_simple))

boxplot(log.tc ~ Test.Location, data=data)
boxplot(log.tc ~ Land.Use, data=data)
boxplot(log.tc ~ Soil.Texture, data=data)

```
There is not any statistically significant variables in this model. Cu and EC are the closest.

Here I also plotted box plots to see if there was a significant difference in the categorical variables. The field and lab almost show a statistical difference but are still overlapping slightly. The rural, urban and ultra urban are not showing much of a difference. The soil texture however seems to have something going on where the critical shear stress could be statiscially different for each soil texture.


# Mixed Model with 3 Random Factors
  # Test Location and Land Use
  
```{r, echo=FALSE, message=FALSE}

library(lme4)

model_mixed <-lmer(log.tc~(1|Test.Location) + (1|Land.Use) + (1|Soil.Texture) + Temp + EC + Cor.Moist + D50 + Cu + Cc + GSD + Pass200, data = data)
summary(model_mixed)
anova(model_mixed)
ranef(model_mixed)

par(mfrow = c(1,1))
plot(model_mixed)
qqnorm(resid(model_mixed))
qqline(resid(model_mixed))

```


# Mixed Model with only Test Location as Random Factor

```{r, echo=FALSE, message=FALSE}

model_mixed2 <-lmer(log.tc~(1|Test.Location) + Temp + EC + Cor.Moist + D50 + Cu + Cc + GSD + Pass200, data = data)
summary(model_mixed2)
anova(model_mixed2)
ranef(model_mixed2)

par(mfrow = c(1,1))
plot(model_mixed2)
qqnorm(resid(model_mixed2))
qqline(resid(model_mixed2))

```


# Mixed Model with only Land Use as Random Factor

```{r, echo=FALSE, message=FALSE}

model_mixed3 <-lmer(tc.I~(1|Land.Use) + Temp + EC + Cor.Moist + D50 + Cu + Cc + GSD + Pass200, data = data)
summary(model_mixed3)
anova(model_mixed3)
ranef(model_mixed3)

par(mfrow = c(1,1))
plot(model_mixed3)
qqnorm(resid(model_mixed3))
qqline(resid(model_mixed3))
```

# Mixed Model with only Soil Texture as Random Factor

```{r, echo=FALSE, message=FALSE}

model_mixed4 <-lmer(tc.I~(1|Soil.Texture) + Temp + EC + Cor.Moist + D50 + Cu + Cc + GSD + Pass200, data = data)
summary(model_mixed4)
anova(model_mixed4)
ranef(model_mixed4)

par(mfrow = c(1,1))
plot(model_mixed4)
qqnorm(resid(model_mixed4))
qqline(resid(model_mixed4))
```

# Mixed Model with Soil Texture and Land Use as Random Factors

```{r, echo=FALSE, message=FALSE}

model_mixed5 <-lmer(tc.I~(1|Soil.Texture) + (1|Land.Use) + Temp + EC + Cor.Moist + D50 + Cu + Cc + GSD + Pass200, data = data)
summary(model_mixed5)
anova(model_mixed5)
ranef(model_mixed5)

par(mfrow = c(1,1))
plot(model_mixed5)
qqnorm(resid(model_mixed5))
qqline(resid(model_mixed5))
```


# Conclusion

 

  
*This is only for my reference when writing the code in R*  
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
